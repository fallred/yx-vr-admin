var ie=Object.defineProperty,ce=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var z=(n,t,o)=>t in n?ie(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,y=(n,t)=>{for(var o in t||(t={}))me.call(t,o)&&z(n,o,t[o]);if(W)for(var o of W(t))pe.call(t,o)&&z(n,o,t[o]);return n},T=(n,t)=>ce(n,de(t));import{r,bw as H,R as e,cy as P,cf as Ee,W as ye,bx as J,s as Q,aj as he,B as I,cY as fe,cZ as xe,c_ as ve,bh as Ce,bn as we,a as De,c$ as ge,d0 as Se,d1 as ke,d2 as Fe,bs as K,bb as Te,T as V,bt as _}from"./index.d85f42cd.js";import"./index.72710f81.js";import{P as Be}from"./Table.24a195f9.js";import{D as Ae}from"./index.9a267f19.js";import{F as Le}from"./index.9188d624.js";import{P as be}from"./ProCard.79118da3.js";import{b,c as $,P as l,a as Y}from"./common.9f7dcf02.js";import{w as q}from"./index.4735b534.js";import{_ as O}from"./index.d8dd6c9b.js";var Ie=["key","name"],Oe=function(t){var o=t.children,m=t.menus,h=t.onSelect,u=t.className,i=t.style,S=r.exports.useContext(H.ConfigContext),v=S.getPrefixCls,C=v("pro-table-dropdown"),w=e.createElement(P,{onClick:function(c){return h&&h(c.key)}},m==null?void 0:m.map(function(p){return e.createElement(P.Item,{key:p.key},p.name)}));return e.createElement(J,{overlay:w,className:Q(C,u)},e.createElement(I,{style:i},o," ",e.createElement(Ae,null)))},U=function(t){var o=t.className,m=t.style,h=t.onSelect,u=t.menus,i=u===void 0?[]:u,S=t.children,v=r.exports.useContext(H.ConfigContext),C=v.getPrefixCls,w=C("pro-table-dropdown"),p=e.createElement(P,{onClick:function(k){return h&&h(k.key)}},i.map(function(c){var k=c.key,F=c.name,E=Ee(c,Ie);return e.createElement(P.Item,ye({key:k},E),F)}));return e.createElement(J,{overlay:p,className:Q(w,o)},e.createElement("a",{style:m},S||e.createElement(he,null)))};U.Button=Oe;var Pe=U;function Z(n){return e.createElement("div",{className:"form-item"},e.createElement("div",{className:"form-item__label"},n.label),e.createElement("span",{className:"form-item__dot"},"\uFF1A"),e.createElement("div",{className:"form-item__content"},n.children))}const{Option:R}=O,Ne=n=>{const{cdRef:t}=n,{data:o}=fe(),m=xe(),h=ve(),[u,i]=e.useState({}),[S,v]=e.useState([]),[C,w]=e.useState([]),[p,c]=e.useState([]),k=async a=>{const A=await m({provinceCode:a});w(A)},F=async a=>{const A=await h({cityCode:a});c(A)},E=a=>{k(a),i(T(y({},u),{province:a,city:void 0,district:void 0})),c([])},B=a=>{F(a),i(T(y({},u),{city:a,district:void 0}))},D=a=>{i(T(y({},u),{district:a}))};return r.exports.useImperativeHandle(t,()=>({getValue:()=>u})),r.exports.useEffect(()=>{v(o)},[o]),e.createElement(e.Fragment,null,e.createElement(Z,{label:"\u5730\u5740"},e.createElement(O,{style:{width:160},showSearch:!0,value:u.province,placeholder:"\u9009\u62E9\u7701",showArrow:!1,filterOption:!1,onChange:E,notFoundContent:null},S.map(a=>e.createElement(R,{key:a.code},a.name))),e.createElement(O,{style:{width:160},showSearch:!0,value:u.city,placeholder:"\u9009\u62E9\u5E02",showArrow:!1,filterOption:!1,onChange:B,notFoundContent:null},C.map(a=>e.createElement(R,{key:a.code},a.name))),e.createElement(O,{style:{width:160},showSearch:!0,value:u.district,placeholder:"\u9009\u62E9\u533A",showArrow:!1,filterOption:!1,onChange:D,notFoundContent:null},p.map(a=>e.createElement(R,{key:a.code},a.name)))))},He=(n={showOperate:!1,filterType:""})=>{const{showOperate:t,filterType:o}=n,m=Ce(we),{formatMessage:h}=De();r.exports.useRef(null),r.exports.useRef();const u=r.exports.useRef(),i=r.exports.useRef(null);r.exports.useState(!1);const[S,v]=r.exports.useState(!1),[C,w]=r.exports.useState(),[p,c]=r.exports.useState({}),[k,F]=r.exports.useState(void 0),[E,B]=r.exports.useState({current:1,pageSize:10,total:0}),[D,a]=r.exports.useState([]),[A,X]=r.exports.useState(""),{data:g,error:Me,isLoading:_e,refetch:L}=ge(E,p);Se(),ke();const{mutateAsync:ee}=Fe();r.exports.useEffect(()=>{w(g==null?void 0:g.data),B(T(y({},E),{total:g==null?void 0:g.total,showQuickJumper:!0}))},[g]),r.exports.useEffect(()=>{L()},[E.current,E.pageSize,p]);const te=()=>{v(!0),F(void 0)},ae=s=>{v(!0),F(s)},ne=()=>{var f;const s=(f=i==null?void 0:i.current)==null?void 0:f.getValue(),d=A.target.value;c(y({keyword:d},s))},oe=()=>{c({province:"",city:"",district:"",keyword:""})},re=s=>{X(s)},N=async s=>{var f;const d=_.loading("\u6B63\u5728\u5220\u9664");if(!s)return!0;try{const x=((f=s.map(le=>le.id))!=null?f:[]).join(",");return await ee({ids:x}),B(T(y({},E),{current:1})),d(),_.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),!0}catch{return d(),_.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),!1}};function se(s){return e.createElement("a",y({},s),s.children)}const M=q(se,m),j=q(I,m),ue=[{key:"appId",title:"\u95E8\u5E97\u7F16\u53F7",dataIndex:"appId",valueType:"text",width:120},{key:"nm",title:"\u95E8\u5E97\u540D\u79F0",dataIndex:"nm",valueType:"text",ellipsis:!0,width:150},{key:"code",title:"\u95E8\u5E97\u7F16\u7801",dataIndex:"code",valueType:"text",width:140},{key:"province",title:"\u7701",dataIndex:"province",valueType:"text",width:100},{key:"city",title:"\u5E02",dataIndex:"city",valueType:"text",width:100},{key:"district",title:"\u533A",dataIndex:"district",valueType:"text",width:100},{key:"address",title:"\u8BE6\u7EC6\u5730\u5740",dataIndex:"address",valueType:"textarea",width:100},{key:"franchisee",title:"\u52A0\u76DF\u5546",dataIndex:"franchisee",valueType:"text",width:100},{key:"manager",title:"\u5E97\u957F",dataIndex:"manager",valueType:"text",width:100},{title:"\u72B6\u6001",width:80,dataIndex:"status",valueEnum:{[b.NORMAL]:{text:$.get(b.NORMAL)},[b.DISABLED]:{text:$.get(b.DISABLED)}}},{title:"\u95E8\u5E97\u8BC4\u7EA7",dataIndex:"grade",valueType:"rate",width:150},{title:"\u5408\u4F19\u4EBA",dataIndex:"partner",valueType:"text",width:120},{title:"\u7B7E\u7EA6\u65F6\u95F4",dataIndex:"tm",valueType:"dateTime",width:120},t?{title:h({id:"gloabal.tips.operation"}),dataIndex:"option",key:"option",valueType:"option",fixed:"right",width:140,render:(s,d)=>{const f=[];return l.DELETE&&f.push({key:l.DELETE,name:"\u5220\u9664"}),[e.createElement(M,{key:l.EDIT,operCode:l.EDIT,onClick:x=>{x.preventDefault(),ae(d)}},"\u7F16\u8F91"),e.createElement(M,{key:l.EDIT,operCode:l.EDIT,onClick:x=>{x.preventDefault()}},"\u7981\u7528"),e.createElement(M,{key:l.DELETE,operCode:l.DELETE,onClick:x=>{x.preventDefault(),K.confirm({title:"\u5220\u9664\u95E8\u5E97",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u95E8\u5E97\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:async()=>{await N([y({},d)]),a([]),L()}})}},"\u5220\u9664"),e.createElement(Pe,{key:"actionGroup",onSelect:x=>{x===l.DELETE&&K.confirm({title:"\u5220\u9664\u95E8\u5E97",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u95E8\u5E97\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:async()=>{await N([y({},d)]),a([]),L()}})},menus:f})]}}:{}];return e.createElement(e.Fragment,null,e.createElement(be,{style:{marginBottom:20}},e.createElement("div",{className:"store-list-search"},e.createElement(Z,{label:"\u5173\u952E\u8BCD"},e.createElement(Te,{placeholder:"\u5173\u952E\u8BCD",style:{width:160},onChange:re})),e.createElement(Ne,{cdRef:i}),e.createElement(I,{type:"primary",onClick:ne},"\u67E5\u8BE2"),e.createElement(I,{onClick:oe},"\u91CD\u7F6E"))),e.createElement(Be,{rowKey:"appId",headerTitle:"\u95E8\u5E97\u7BA1\u7406",defaultSize:"small",actionRef:u,scroll:{x:1e3},bordered:!1,options:{reload:!1},toolBarRender:()=>t?[e.createElement(j,{type:"primary",key:"primary",onClick:te,operCode:l.ADD},Y.get(l.ADD))]:[],request:void 0,dataSource:C,columns:ue,pagination:E,hideOnSinglePage:!0,onChange:(s,d,f)=>{B(s)},rowSelection:{onChange:(s,d)=>{a(d)}},search:!1,footer:!1}),(D==null?void 0:D.length)>0&&e.createElement(Le,{extra:e.createElement("div",null,e.createElement(V,{id:"app.project.chosen",defaultMessage:"\u5DF2\u9009\u62E9"})," ",e.createElement("a",{style:{fontWeight:600}},D.length)," ",e.createElement(V,{id:"app.project.item",defaultMessage:"\u9879"}))},t?e.createElement(j,{type:"primary",key:"primary",onClick:async()=>{await N(D),a([]),L()},operCode:l.DELETE},Y.get(l.DELETE)):null))};export{He as S,Pe as T};
